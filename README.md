# eszett
Test: employee storage service for companies

# Docker compose
To start the server execute from within this folder:
`make run`

Check the default UI at http://127.0.0.1:8080/ on your machine.

Stop composer by interrupting it with Ctrl+c, and then execute:
`make down`

Note that the project cannot be run directly (i.e. using only ./gradlew) as it doesn't contain any DB connection
parameters outside of docker.

# Initial data
Check src/main/resources/db/migration/V2021.03.26.22.41.00__Add_initial_dummy_data.sql

After it is loaded, there will be a single superuser `kris/kris01`. No admin users will be created.

# API calls
Only some standard entry points generated by Spring Data REST are open as per security requirements, and only for logged
in users.

| API Endpoint | superuser | admin |
| :---: | :---: | :---: |
| `GET /companies` | list all companies | list with only user's company |
| `POST /companies` | create a new company | - |
| `GET /companies/{id}` | details about the company | works only for user's company ID |
| `PUT /companies/{id}` | replace or create company | works only for user's company ID |
| `PATCH /companies/{id}` | update company | works only for user's company ID |
| `DELETE /companies/{id}` | delete company | - |
| --- | --- | --- |
| `GET /employees` | list all employees | list employees only within user's company |
| `POST /employees` | create a new employee | works only within user's company |
| `GET /employees/{id}` | details about the employee | -<sup>*</sup> |
| `PUT /employees/{id}` | replace or create employee | works only within user's company |
| `PATCH /employees/{id}` | update employee | works only within user's company |
| `DELETE /employees/{id}` | delete employee | works only within user's company |
| --- | --- | --- |
| `/companies/{id}/employees/**` | company's related employees' endpoints | works only within user's company |
| `/employees/{id}/company/**` | employee's related company's endpoints | - |

<sup>*</sup>Forbidden for security. Instead, please use `GET /companies/{c_id}/employees/{e_id}` call.

Basic authentication is used, so all these are easily testable with `curl` and `-u user:pass` command. Note that
`-H 'Content-type: application/json'` is required.
